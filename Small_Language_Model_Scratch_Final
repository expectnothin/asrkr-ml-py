{
  "cells": [
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "ijDG3IDqkjKx"
      },
      "source": [
        "# Introduction\n",
        "\n",
        "Let us build a Small Language Model (SLM) from scratch. We will try to keep the parameter size to 10-15 million.\n",
        "\n",
        "Our goal is to generate creative and coherent text based on the input data."
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "## Step 1: Import the Dataset\n",
        "\n",
        "TinyStories is a synthetic dataset of short stories that only contain words that a typical 3 to 4-year-olds usually understand, generated by GPT-3.5 and GPT-4. We can get it from HuggingFace."
      ],
      "metadata": {
        "id": "tPl23BNsRqfm"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "!pip install datasets"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "BSeXbOztRtKN",
        "outputId": "f2dc514d-77f3-433c-86f5-c6b23be60fc7"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Requirement already satisfied: datasets in /usr/local/lib/python3.11/dist-packages (2.14.4)\n",
            "Requirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.11/dist-packages (from datasets) (2.0.2)\n",
            "Requirement already satisfied: pyarrow>=8.0.0 in /usr/local/lib/python3.11/dist-packages (from datasets) (18.1.0)\n",
            "Requirement already satisfied: dill<0.3.8,>=0.3.0 in /usr/local/lib/python3.11/dist-packages (from datasets) (0.3.7)\n",
            "Requirement already satisfied: pandas in /usr/local/lib/python3.11/dist-packages (from datasets) (2.2.2)\n",
            "Requirement already satisfied: requests>=2.19.0 in /usr/local/lib/python3.11/dist-packages (from datasets) (2.32.3)\n",
            "Requirement already satisfied: tqdm>=4.62.1 in /usr/local/lib/python3.11/dist-packages (from datasets) (4.67.1)\n",
            "Requirement already satisfied: xxhash in /usr/local/lib/python3.11/dist-packages (from datasets) (3.5.0)\n",
            "Requirement already satisfied: multiprocess in /usr/local/lib/python3.11/dist-packages (from datasets) (0.70.15)\n",
            "Requirement already satisfied: fsspec>=2021.11.1 in /usr/local/lib/python3.11/dist-packages (from fsspec[http]>=2021.11.1->datasets) (2025.3.2)\n",
            "Requirement already satisfied: aiohttp in /usr/local/lib/python3.11/dist-packages (from datasets) (3.11.15)\n",
            "Requirement already satisfied: huggingface-hub<1.0.0,>=0.14.0 in /usr/local/lib/python3.11/dist-packages (from datasets) (0.33.4)\n",
            "Requirement already satisfied: packaging in /usr/local/lib/python3.11/dist-packages (from datasets) (25.0)\n",
            "Requirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.11/dist-packages (from datasets) (6.0.2)\n",
            "Requirement already satisfied: aiohappyeyeballs>=2.3.0 in /usr/local/lib/python3.11/dist-packages (from aiohttp->datasets) (2.6.1)\n",
            "Requirement already satisfied: aiosignal>=1.1.2 in /usr/local/lib/python3.11/dist-packages (from aiohttp->datasets) (1.4.0)\n",
            "Requirement already satisfied: attrs>=17.3.0 in /usr/local/lib/python3.11/dist-packages (from aiohttp->datasets) (25.3.0)\n",
            "Requirement already satisfied: frozenlist>=1.1.1 in /usr/local/lib/python3.11/dist-packages (from aiohttp->datasets) (1.7.0)\n",
            "Requirement already satisfied: multidict<7.0,>=4.5 in /usr/local/lib/python3.11/dist-packages (from aiohttp->datasets) (6.6.3)\n",
            "Requirement already satisfied: propcache>=0.2.0 in /usr/local/lib/python3.11/dist-packages (from aiohttp->datasets) (0.3.2)\n",
            "Requirement already satisfied: yarl<2.0,>=1.17.0 in /usr/local/lib/python3.11/dist-packages (from aiohttp->datasets) (1.20.1)\n",
            "Requirement already satisfied: filelock in /usr/local/lib/python3.11/dist-packages (from huggingface-hub<1.0.0,>=0.14.0->datasets) (3.18.0)\n",
            "Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.11/dist-packages (from huggingface-hub<1.0.0,>=0.14.0->datasets) (4.14.1)\n",
            "Requirement already satisfied: hf-xet<2.0.0,>=1.1.2 in /usr/local/lib/python3.11/dist-packages (from huggingface-hub<1.0.0,>=0.14.0->datasets) (1.1.5)\n",
            "Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.11/dist-packages (from requests>=2.19.0->datasets) (3.4.2)\n",
            "Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.11/dist-packages (from requests>=2.19.0->datasets) (3.10)\n",
            "Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.11/dist-packages (from requests>=2.19.0->datasets) (2.4.0)\n",
            "Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.11/dist-packages (from requests>=2.19.0->datasets) (2025.7.14)\n",
            "Requirement already satisfied: python-dateutil>=2.8.2 in /usr/local/lib/python3.11/dist-packages (from pandas->datasets) (2.9.0.post0)\n",
            "Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.11/dist-packages (from pandas->datasets) (2025.2)\n",
            "Requirement already satisfied: tzdata>=2022.7 in /usr/local/lib/python3.11/dist-packages (from pandas->datasets) (2025.2)\n",
            "Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.11/dist-packages (from python-dateutil>=2.8.2->pandas->datasets) (1.17.0)\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "pip install -U datasets\n"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "AkpPWqR8-tFO",
        "outputId": "5ada8564-d294-4732-d866-3264175e43fa"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Requirement already satisfied: datasets in /usr/local/lib/python3.11/dist-packages (4.0.0)\n",
            "Requirement already satisfied: filelock in /usr/local/lib/python3.11/dist-packages (from datasets) (3.18.0)\n",
            "Requirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.11/dist-packages (from datasets) (2.0.2)\n",
            "Requirement already satisfied: pyarrow>=15.0.0 in /usr/local/lib/python3.11/dist-packages (from datasets) (18.1.0)\n",
            "Requirement already satisfied: dill<0.3.9,>=0.3.0 in /usr/local/lib/python3.11/dist-packages (from datasets) (0.3.7)\n",
            "Requirement already satisfied: pandas in /usr/local/lib/python3.11/dist-packages (from datasets) (2.2.2)\n",
            "Requirement already satisfied: requests>=2.32.2 in /usr/local/lib/python3.11/dist-packages (from datasets) (2.32.3)\n",
            "Requirement already satisfied: tqdm>=4.66.3 in /usr/local/lib/python3.11/dist-packages (from datasets) (4.67.1)\n",
            "Requirement already satisfied: xxhash in /usr/local/lib/python3.11/dist-packages (from datasets) (3.5.0)\n",
            "Requirement already satisfied: multiprocess<0.70.17 in /usr/local/lib/python3.11/dist-packages (from datasets) (0.70.15)\n",
            "Requirement already satisfied: fsspec<=2025.3.0,>=2023.1.0 in /usr/local/lib/python3.11/dist-packages (from fsspec[http]<=2025.3.0,>=2023.1.0->datasets) (2025.3.0)\n",
            "Requirement already satisfied: huggingface-hub>=0.24.0 in /usr/local/lib/python3.11/dist-packages (from datasets) (0.33.4)\n",
            "Requirement already satisfied: packaging in /usr/local/lib/python3.11/dist-packages (from datasets) (25.0)\n",
            "Requirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.11/dist-packages (from datasets) (6.0.2)\n",
            "Requirement already satisfied: aiohttp!=4.0.0a0,!=4.0.0a1 in /usr/local/lib/python3.11/dist-packages (from fsspec[http]<=2025.3.0,>=2023.1.0->datasets) (3.11.15)\n",
            "Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.11/dist-packages (from huggingface-hub>=0.24.0->datasets) (4.14.1)\n",
            "Requirement already satisfied: hf-xet<2.0.0,>=1.1.2 in /usr/local/lib/python3.11/dist-packages (from huggingface-hub>=0.24.0->datasets) (1.1.5)\n",
            "Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.11/dist-packages (from requests>=2.32.2->datasets) (3.4.2)\n",
            "Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.11/dist-packages (from requests>=2.32.2->datasets) (3.10)\n",
            "Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.11/dist-packages (from requests>=2.32.2->datasets) (2.4.0)\n",
            "Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.11/dist-packages (from requests>=2.32.2->datasets) (2025.7.14)\n",
            "Requirement already satisfied: python-dateutil>=2.8.2 in /usr/local/lib/python3.11/dist-packages (from pandas->datasets) (2.9.0.post0)\n",
            "Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.11/dist-packages (from pandas->datasets) (2025.2)\n",
            "Requirement already satisfied: tzdata>=2022.7 in /usr/local/lib/python3.11/dist-packages (from pandas->datasets) (2025.2)\n",
            "Requirement already satisfied: aiohappyeyeballs>=2.3.0 in /usr/local/lib/python3.11/dist-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]<=2025.3.0,>=2023.1.0->datasets) (2.6.1)\n",
            "Requirement already satisfied: aiosignal>=1.1.2 in /usr/local/lib/python3.11/dist-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]<=2025.3.0,>=2023.1.0->datasets) (1.4.0)\n",
            "Requirement already satisfied: attrs>=17.3.0 in /usr/local/lib/python3.11/dist-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]<=2025.3.0,>=2023.1.0->datasets) (25.3.0)\n",
            "Requirement already satisfied: frozenlist>=1.1.1 in /usr/local/lib/python3.11/dist-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]<=2025.3.0,>=2023.1.0->datasets) (1.7.0)\n",
            "Requirement already satisfied: multidict<7.0,>=4.5 in /usr/local/lib/python3.11/dist-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]<=2025.3.0,>=2023.1.0->datasets) (6.6.3)\n",
            "Requirement already satisfied: propcache>=0.2.0 in /usr/local/lib/python3.11/dist-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]<=2025.3.0,>=2023.1.0->datasets) (0.3.2)\n",
            "Requirement already satisfied: yarl<2.0,>=1.17.0 in /usr/local/lib/python3.11/dist-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]<=2025.3.0,>=2023.1.0->datasets) (1.20.1)\n",
            "Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.11/dist-packages (from python-dateutil>=2.8.2->pandas->datasets) (1.17.0)\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "from google.colab import files\n",
        "files.download(\"/content/TinyStories/train.jsonl\")"
      ],
      "metadata": {
        "id": "3o5BEWyFjcEx",
        "outputId": "d1441711-a0a8-4820-a203-86a2f4ef2290",
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 293
        }
      },
      "execution_count": 1,
      "outputs": [
        {
          "output_type": "error",
          "ename": "FileNotFoundError",
          "evalue": "Cannot find file: /content/TinyStories/train.jsonl",
          "traceback": [
            "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
            "\u001b[0;31mFileNotFoundError\u001b[0m                         Traceback (most recent call last)",
            "\u001b[0;32m/tmp/ipython-input-1-2531461271.py\u001b[0m in \u001b[0;36m<cell line: 0>\u001b[0;34m()\u001b[0m\n\u001b[1;32m      1\u001b[0m \u001b[0;32mfrom\u001b[0m \u001b[0mgoogle\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcolab\u001b[0m \u001b[0;32mimport\u001b[0m \u001b[0mfiles\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 2\u001b[0;31m \u001b[0mfiles\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mdownload\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\"/content/TinyStories/train.jsonl\"\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m",
            "\u001b[0;32m/usr/local/lib/python3.11/dist-packages/google/colab/files.py\u001b[0m in \u001b[0;36mdownload\u001b[0;34m(filename)\u001b[0m\n\u001b[1;32m    231\u001b[0m   \u001b[0;32mif\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0m_os\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mpath\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mexists\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mfilename\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    232\u001b[0m     \u001b[0mmsg\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;34m'Cannot find file: {}'\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mformat\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mfilename\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 233\u001b[0;31m     \u001b[0;32mraise\u001b[0m \u001b[0mFileNotFoundError\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mmsg\u001b[0m\u001b[0;34m)\u001b[0m  \u001b[0;31m# pylint: disable=undefined-variable\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    234\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    235\u001b[0m   \u001b[0mcomm_manager\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0m_IPython\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mget_ipython\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mkernel\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcomm_manager\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;31mFileNotFoundError\u001b[0m: Cannot find file: /content/TinyStories/train.jsonl"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "!ls -lh /content/TinyStories\n",
        "\n",
        "import json\n",
        "\n",
        "input_file = \"/content/TinyStories/TinyStories-train.txt\"\n",
        "output_file = \"/content/TinyStories/train.jsonl\"\n",
        "\n",
        "with open(input_file, \"r\") as f_in, open(output_file, \"w\") as f_out:\n",
        "    for line in f_in:\n",
        "        f_out.write(json.dumps({\"text\": line.strip()}) + \"\\n\")\n",
        "\n"
      ],
      "metadata": {
        "outputId": "67290844-0eaa-4c29-9a2f-f62a3bc6ef0d",
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "N0NXpg9HjeeX"
      },
      "execution_count": 4,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "total 6.2G\n",
            "drwxr-xr-x 2 root root 4.0K Jul 23 13:59  data\n",
            "-rw-r--r-- 1 root root  12K Jul 23 13:58 'Evaluation prompts.yaml'\n",
            "-rw-r--r-- 1 root root 782M Jul 23 14:01  MLP_input_output.npy\n",
            "-rw-r--r-- 1 root root 1.1K Jul 23 13:58  README.md\n",
            "-rw-r--r-- 1 root root 1.5G Jul 23 14:03  TinyStories_all_data.tar.gz\n",
            "-rw-r--r-- 1 root root 1.8G Jul 23 14:04  TinyStories-train.txt\n",
            "-rw-r--r-- 1 root root 2.1G Jul 23 14:05  TinyStoriesV2-GPT4-train.txt\n",
            "-rw-r--r-- 1 root root  22M Jul 23 13:58  TinyStoriesV2-GPT4-valid.txt\n",
            "-rw-r--r-- 1 root root  19M Jul 23 13:58  TinyStories-valid.txt\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "!pip install datasets==2.17.0 --no-deps --quiet\n",
        "from datasets import load_dataset\n",
        "from datasets import Dataset\n",
        "\n",
        "!head /content/TinyStories/train.jsonl\n",
        "\n",
        "from datasets import Dataset\n",
        "ds = Dataset.from_json(\"/content/TinyStories/train.jsonl\")\n",
        "\n",
        "# ds = load_dataset(\"roneneldan/TinyStories\", split=\"train\")\n",
        "# Peek inside\n",
        "print(ds)\n",
        "print(ds[0])"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 592
        },
        "id": "Bl1G1zOOpVvu",
        "outputId": "612cb54b-70ec-49d2-9978-70bf138099f6"
      },
      "execution_count": 16,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "{\"text\": \"One day, a little girl named Lily found a needle in her room. She knew it was difficult to play with it because it was sharp. Lily wanted to share the needle with her mom, so she could sew a button on her shirt.\"}\n",
            "{\"text\": \"Lily went to her mom and said, \\\"Mom, I found this needle. Can you share it with me and sew my shirt?\\\" Her mom smiled and said, \\\"Yes, Lily, we can share the needle and fix your shirt.\\\"\"}\n",
            "{\"text\": \"Together, they shared the needle and sewed the button on Lily's shirt. It was not difficult for them because they were sharing and helping each other. After they finished, Lily thanked her mom for sharing the needle and fixing her shirt. They both felt happy because they had shared and worked together.\"}\n",
            "{\"text\": \"<|endoftext|>\"}\n",
            "{\"text\": \"Once upon a time, there was a little car named Beep. Beep loved to go fast and play in the sun. Beep was a healthy car because he always had good fuel. Good fuel made Beep happy and strong.\"}\n",
            "{\"text\": \"One day, Beep was driving in the park when he saw a big tree. The tree had many leaves that were falling. Beep liked how the leaves fall and wanted to play with them. Beep drove under the tree and watched the leaves fall on him. He laughed and beeped his horn.\"}\n",
            "{\"text\": \"Beep played with the falling leaves all day. When it was time to go home, Beep knew he needed more fuel. He went to the fuel place and got more healthy fuel. Now, Beep was ready to go fast and play again the next day. And Beep lived happily ever after.\"}\n",
            "{\"text\": \"<|endoftext|>\"}\n",
            "{\"text\": \"One day, a little fish named Fin was swimming near the shore. He saw a big crab and wanted to be friends. \\\"Hi, I am Fin. Do you want to play?\\\" asked the little fish. The crab looked at Fin and said, \\\"No, I don't want to play. I am cold and I don't feel fine.\\\"\"}\n",
            "{\"text\": \"Fin felt sad but wanted to help the crab feel better. He swam away and thought of a plan. He remembered that the sun could make things warm. So, Fin swam to the top of the water and called to the sun, \\\"Please, sun, help my new friend feel fine and not freeze!\\\"\"}\n"
          ]
        },
        {
          "output_type": "error",
          "ename": "NotImplementedError",
          "evalue": "Loading a dataset cached in a LocalFileSystem is not supported.",
          "traceback": [
            "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
            "\u001b[0;31mNotImplementedError\u001b[0m                       Traceback (most recent call last)",
            "\u001b[0;32m/tmp/ipython-input-16-4080873827.py\u001b[0m in \u001b[0;36m<cell line: 0>\u001b[0;34m()\u001b[0m\n\u001b[1;32m      6\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      7\u001b[0m \u001b[0;32mfrom\u001b[0m \u001b[0mdatasets\u001b[0m \u001b[0;32mimport\u001b[0m \u001b[0mDataset\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 8\u001b[0;31m \u001b[0mds\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mDataset\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mfrom_json\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\"/content/TinyStories/train.jsonl\"\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      9\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     10\u001b[0m \u001b[0;31m# ds = load_dataset(\"roneneldan/TinyStories\", split=\"train\")\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;32m/usr/local/lib/python3.11/dist-packages/datasets/arrow_dataset.py\u001b[0m in \u001b[0;36mfrom_json\u001b[0;34m(path_or_paths, split, features, cache_dir, keep_in_memory, field, num_proc, **kwargs)\u001b[0m\n\u001b[1;32m   1127\u001b[0m             \u001b[0mkeep_in_memory\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mkeep_in_memory\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1128\u001b[0m             \u001b[0mfield\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mfield\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1129\u001b[0;31m             \u001b[0mnum_proc\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mnum_proc\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1130\u001b[0m             \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1131\u001b[0m         ).read()\n",
            "\u001b[0;32m/usr/local/lib/python3.11/dist-packages/datasets/io/json.py\u001b[0m in \u001b[0;36mread\u001b[0;34m(self)\u001b[0m\n\u001b[1;32m     65\u001b[0m                 \u001b[0mnum_proc\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mnum_proc\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     66\u001b[0m             )\n\u001b[0;32m---> 67\u001b[0;31m             dataset = self.builder.as_dataset(\n\u001b[0m\u001b[1;32m     68\u001b[0m                 \u001b[0msplit\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msplit\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mverification_mode\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mverification_mode\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0min_memory\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mkeep_in_memory\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     69\u001b[0m             )\n",
            "\u001b[0;32m/usr/local/lib/python3.11/dist-packages/datasets/builder.py\u001b[0m in \u001b[0;36mas_dataset\u001b[0;34m(self, split, run_post_process, verification_mode, ignore_verifications, in_memory)\u001b[0m\n\u001b[1;32m   1171\u001b[0m         \u001b[0mignore_verifications\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m\"deprecated\"\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1172\u001b[0m         \u001b[0min_memory\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mFalse\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1173\u001b[0;31m     ) -> Union[Dataset, DatasetDict]:\n\u001b[0m\u001b[1;32m   1174\u001b[0m         \"\"\"Return a Dataset for the specified split.\n\u001b[1;32m   1175\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;31mNotImplementedError\u001b[0m: Loading a dataset cached in a LocalFileSystem is not supported."
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "!ls -lh /content/TinyStories/train.jsonl\n",
        "!head /content/TinyStories/train.jsonl"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "G9v6YT-2tCds",
        "outputId": "ea30eb15-0019-4109-9eb5-c24a8f2558c8"
      },
      "execution_count": 17,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "-rw-r--r-- 1 root root 2.0G Jul 23 14:16 /content/TinyStories/train.jsonl\n",
            "{\"text\": \"One day, a little girl named Lily found a needle in her room. She knew it was difficult to play with it because it was sharp. Lily wanted to share the needle with her mom, so she could sew a button on her shirt.\"}\n",
            "{\"text\": \"Lily went to her mom and said, \\\"Mom, I found this needle. Can you share it with me and sew my shirt?\\\" Her mom smiled and said, \\\"Yes, Lily, we can share the needle and fix your shirt.\\\"\"}\n",
            "{\"text\": \"Together, they shared the needle and sewed the button on Lily's shirt. It was not difficult for them because they were sharing and helping each other. After they finished, Lily thanked her mom for sharing the needle and fixing her shirt. They both felt happy because they had shared and worked together.\"}\n",
            "{\"text\": \"<|endoftext|>\"}\n",
            "{\"text\": \"Once upon a time, there was a little car named Beep. Beep loved to go fast and play in the sun. Beep was a healthy car because he always had good fuel. Good fuel made Beep happy and strong.\"}\n",
            "{\"text\": \"One day, Beep was driving in the park when he saw a big tree. The tree had many leaves that were falling. Beep liked how the leaves fall and wanted to play with them. Beep drove under the tree and watched the leaves fall on him. He laughed and beeped his horn.\"}\n",
            "{\"text\": \"Beep played with the falling leaves all day. When it was time to go home, Beep knew he needed more fuel. He went to the fuel place and got more healthy fuel. Now, Beep was ready to go fast and play again the next day. And Beep lived happily ever after.\"}\n",
            "{\"text\": \"<|endoftext|>\"}\n",
            "{\"text\": \"One day, a little fish named Fin was swimming near the shore. He saw a big crab and wanted to be friends. \\\"Hi, I am Fin. Do you want to play?\\\" asked the little fish. The crab looked at Fin and said, \\\"No, I don't want to play. I am cold and I don't feel fine.\\\"\"}\n",
            "{\"text\": \"Fin felt sad but wanted to help the crab feel better. He swam away and thought of a plan. He remembered that the sun could make things warm. So, Fin swam to the top of the water and called to the sun, \\\"Please, sun, help my new friend feel fine and not freeze!\\\"\"}\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "from datasets import Dataset\n",
        "ds = Dataset.from_json(\"/content/TinyStories/train.jsonl\")\n",
        "print(ds)\n",
        "print(ds[0])"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 160,
          "referenced_widgets": [
            "b341f76ab47c4aefafaaf7fdb48d7f87",
            "6eac3ad88c764a38bd19cf3740c1f5a0",
            "e537d49e35cb48469612017d96d67689",
            "3b61944e18a347e4a88ff0b22e60e113",
            "b3fe02f80d634358bc4dea909061b81d",
            "f8abed28499e49508887710a07d5f230",
            "30b8c8dc62a1479e91c1bfa35f7a6f76",
            "342488b1ebff470487902a3f10694c50",
            "39984545f4554e8e99af81b4d1beca05",
            "d4d7c7d656524fb9a69bd8a7cd92110a",
            "2be100b93d6541edb230d2566bc56b7c"
          ]
        },
        "id": "rzMsdESHtzkk",
        "outputId": "bd29abec-0938-4378-e2d6-2bd8f9e04d75"
      },
      "execution_count": 2,
      "outputs": [
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "Generating train split: 0 examples [00:00, ? examples/s]"
            ],
            "application/vnd.jupyter.widget-view+json": {
              "version_major": 2,
              "version_minor": 0,
              "model_id": "b341f76ab47c4aefafaaf7fdb48d7f87"
            }
          },
          "metadata": {}
        },
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Dataset({\n",
            "    features: ['text'],\n",
            "    num_rows: 14815490\n",
            "})\n",
            "{'text': 'One day, a little girl named Lily found a needle in her room. She knew it was difficult to play with it because it was sharp. Lily wanted to share the needle with her mom, so she could sew a button on her shirt.'}\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [],
      "metadata": {
        "id": "hRxgf1_fkiFX"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "!apt-get install git-lfs\n",
        "!git lfs install\n",
        "\n",
        "%cd /content/\n",
        "!git clone https://huggingface.co/datasets/roneneldan/TinyStories\n",
        "%cd TinyStories\n",
        "!git lfs pull\n",
        "\n",
        "!ls -lh /content/TinyStories\n",
        "\n",
        "from datasets import load_dataset\n",
        "!rm -rf ~/.cache/huggingface/datasets\n",
        "!rm -rf ~/.cache/huggingface/hub\n",
        "!rm -rf ./tmp_dataset_cache\n",
        "\n",
        "!ls -lh /content/TinyStories\n",
        "\n",
        "# ds = load_dataset(\"roneneldan/TinyStories\", download_mode=\"force_redownload\")"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "fbc450c2-92fe-4d4c-9ef6-e283311bfcb6",
        "id": "Nrju4oIPh3Ln"
      },
      "execution_count": 3,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Reading package lists... Done\n",
            "Building dependency tree... Done\n",
            "Reading state information... Done\n",
            "git-lfs is already the newest version (3.0.2-1ubuntu0.3).\n",
            "0 upgraded, 0 newly installed, 0 to remove and 35 not upgraded.\n",
            "Git LFS initialized.\n",
            "/content\n",
            "Cloning into 'TinyStories'...\n",
            "remote: Enumerating objects: 69, done.\u001b[K\n",
            "remote: Counting objects: 100% (3/3), done.\u001b[K\n",
            "remote: Compressing objects: 100% (3/3), done.\u001b[K\n",
            "remote: Total 69 (delta 0), reused 0 (delta 0), pack-reused 66 (from 1)\u001b[K\n",
            "Unpacking objects: 100% (69/69), 14.51 KiB | 707.00 KiB/s, done.\n",
            "Filtering content: 100% (11/11), 7.09 GiB | 18.38 MiB/s, done.\n",
            "/content/TinyStories\n",
            "total 6.2G\n",
            "drwxr-xr-x 2 root root 4.0K Jul 23 13:59  data\n",
            "-rw-r--r-- 1 root root  12K Jul 23 13:58 'Evaluation prompts.yaml'\n",
            "-rw-r--r-- 1 root root 782M Jul 23 14:01  MLP_input_output.npy\n",
            "-rw-r--r-- 1 root root 1.1K Jul 23 13:58  README.md\n",
            "-rw-r--r-- 1 root root 1.5G Jul 23 14:03  TinyStories_all_data.tar.gz\n",
            "-rw-r--r-- 1 root root 1.8G Jul 23 14:04  TinyStories-train.txt\n",
            "-rw-r--r-- 1 root root 2.1G Jul 23 14:05  TinyStoriesV2-GPT4-train.txt\n",
            "-rw-r--r-- 1 root root  22M Jul 23 13:58  TinyStoriesV2-GPT4-valid.txt\n",
            "-rw-r--r-- 1 root root  19M Jul 23 13:58  TinyStories-valid.txt\n",
            "total 6.2G\n",
            "drwxr-xr-x 2 root root 4.0K Jul 23 13:59  data\n",
            "-rw-r--r-- 1 root root  12K Jul 23 13:58 'Evaluation prompts.yaml'\n",
            "-rw-r--r-- 1 root root 782M Jul 23 14:01  MLP_input_output.npy\n",
            "-rw-r--r-- 1 root root 1.1K Jul 23 13:58  README.md\n",
            "-rw-r--r-- 1 root root 1.5G Jul 23 14:03  TinyStories_all_data.tar.gz\n",
            "-rw-r--r-- 1 root root 1.8G Jul 23 14:04  TinyStories-train.txt\n",
            "-rw-r--r-- 1 root root 2.1G Jul 23 14:05  TinyStoriesV2-GPT4-train.txt\n",
            "-rw-r--r-- 1 root root  22M Jul 23 13:58  TinyStoriesV2-GPT4-valid.txt\n",
            "-rw-r--r-- 1 root root  19M Jul 23 13:58  TinyStories-valid.txt\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "!apt-get install git-lfs\n",
        "!git lfs install\n",
        "\n",
        "%cd /content/\n",
        "!git clone https://huggingface.co/datasets/roneneldan/TinyStories\n",
        "%cd TinyStories\n",
        "!git lfs pull\n",
        "\n",
        "!ls -lh /content/TinyStories\n",
        "\n",
        "from datasets import load_dataset\n",
        "!rm -rf ~/.cache/huggingface/datasets\n",
        "!rm -rf ~/.cache/huggingface/hub\n",
        "!rm -rf ./tmp_dataset_cache\n",
        "\n",
        "!ls -lh /content/TinyStories\n",
        "\n",
        "# ds = load_dataset(\"roneneldan/TinyStories\", download_mode=\"force_redownload\")"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 1000,
          "referenced_widgets": [
            "b72c1c545585406f9ce906dea2102d13",
            "e900edc26adc41c8b6710ba6141ac468",
            "affacbc06f2d42428e01820485a81f66",
            "a3fe6c84fda14ec394670331292977fe",
            "d8596cd0d1484d0eb85888781d524ecb",
            "47926ced7eaf43aea45e8771d8702a81",
            "d4fa3b28722e4ef2a3bd12b433278d82",
            "335a7531010b43b6b876eba21cda6433",
            "43bfe27a5b1e48b88d28348d143d1c52",
            "a8eba309071146339ba093c72dd6473e",
            "901fc991c8794f79ac1b3db5030fe20e",
            "f88e7dfa8aa0471e8e46f01748db58ea",
            "61405d0fccbd4a048813cf779f3e47ee",
            "419c5055c04d453db2722f10857bca0e",
            "69ee9c5dbcb84805826def3d501d58a1",
            "78af81a039d44607b358c93697c0ed33",
            "737e9849c3fe4020a5a9f17620a815f1",
            "2c956e07033d4daf9abfa628d8a90e6f",
            "c27a7448f38440e98df5dae9a65d2dd6",
            "71effa3ad61e4f7c8a612c5741be9fe4",
            "f48a1e23bc694f70ade9d0b5b77bc435",
            "172aabadeff648789066a2e195adc75b",
            "ac8a44eaaf6c41e2a457c4edb8e12263",
            "31658a697e7e438cbe7b41050873c640",
            "87736d9336e34289bed0bcf80274ec59",
            "44552002ff1749da85e369d220f609df",
            "89ee047f74e248228701ba9c12b77b54",
            "9164bf72d04c479cb3976801a3c2a558",
            "15aefbebba874c69813a2ebf972d592c",
            "1b3f1c80944147a885f5e12819480525",
            "b3582aa66b924092a43f76135870e2f5",
            "ee32053db2ca4b279e77bcb72c7160c6",
            "50252b5e89d14d70a977ba057b22d1c5",
            "1ea2cb07ffb2430bbc1cf4df7ad92352",
            "039e4cf4cea94f08beb764ad880dbbb3",
            "b40c76a699e44dbd8ab444c0a475cafa",
            "aea486c77b694df3970fa1305694cd85",
            "af7007cad5414aa39823bc8c38fce802",
            "b8165231fe7946aa9a91af83a882bd2d",
            "0dca51fe3d5949bc8b0875d56de35094",
            "10c1ffe15a2d45e0b87d65cad404fd02",
            "6c07e58ce662466380e27307f669d6ca",
            "398a9b23ec194939a29ab7d77dfe00e7",
            "92a900a6ed89453db8181e69240cb2f7",
            "6fdbd0591b4d451baa5002fca1717507",
            "67bf28190ca0447eaf09524fed4c86ba",
            "3e11b3fa13ab40e5a76f55c170a1492a",
            "66321f4176ed439fb299623ed77a34fe",
            "080701ac49b84b13ac6c3bb6a3b0794f",
            "b3d79fd9bc074f17aa77368232544627",
            "289d2caa1583498f9c9a8501e2cf01a4",
            "ff68f799f20a4fc5ba1778fcf6ea6074",
            "932c8100c90645eb98a3f6b91ee7a97f",
            "c7844193fdc24630ab01ce5eef6a2270",
            "24099522850c43da9d4e8d05e5cf2548"
          ]
        },
        "id": "3r34TTsnR3GI",
        "outputId": "0453835a-d6f0-4941-d48f-6f2507b49d71"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Reading package lists... Done\n",
            "Building dependency tree... Done\n",
            "Reading state information... Done\n",
            "git-lfs is already the newest version (3.0.2-1ubuntu0.3).\n",
            "0 upgraded, 0 newly installed, 0 to remove and 35 not upgraded.\n",
            "Git LFS initialized.\n",
            "/content\n",
            "Cloning into 'TinyStories'...\n",
            "remote: Enumerating objects: 69, done.\u001b[K\n",
            "remote: Counting objects: 100% (69/69), done.\u001b[K\n",
            "remote: Compressing objects: 100% (50/50), done.\u001b[K\n",
            "remote: Total 69 (delta 23), reused 58 (delta 18), pack-reused 0 (from 0)\u001b[K\n",
            "Unpacking objects: 100% (69/69), 13.62 KiB | 929.00 KiB/s, done.\n",
            "Filtering content: 100% (11/11), 7.09 GiB | 19.23 MiB/s, done.\n",
            "/content/TinyStories\n",
            "total 6.2G\n",
            "drwxr-xr-x 2 root root 4.0K Jul 23 13:37  data\n",
            "-rw-r--r-- 1 root root  12K Jul 23 13:36 'Evaluation prompts.yaml'\n",
            "-rw-r--r-- 1 root root 782M Jul 23 13:39  MLP_input_output.npy\n",
            "-rw-r--r-- 1 root root 1.1K Jul 23 13:36  README.md\n",
            "-rw-r--r-- 1 root root 1.5G Jul 23 13:40  TinyStories_all_data.tar.gz\n",
            "-rw-r--r-- 1 root root 1.8G Jul 23 13:41  TinyStories-train.txt\n",
            "-rw-r--r-- 1 root root 2.1G Jul 23 13:42  TinyStoriesV2-GPT4-train.txt\n",
            "-rw-r--r-- 1 root root  22M Jul 23 13:36  TinyStoriesV2-GPT4-valid.txt\n",
            "-rw-r--r-- 1 root root  19M Jul 23 13:37  TinyStories-valid.txt\n"
          ]
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "Downloading readme: 0.00B [00:00, ?B/s]"
            ],
            "application/vnd.jupyter.widget-view+json": {
              "version_major": 2,
              "version_minor": 0,
              "model_id": "b72c1c545585406f9ce906dea2102d13"
            }
          },
          "metadata": {}
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "Downloading data files:   0%|          | 0/2 [00:00<?, ?it/s]"
            ],
            "application/vnd.jupyter.widget-view+json": {
              "version_major": 2,
              "version_minor": 0,
              "model_id": "f88e7dfa8aa0471e8e46f01748db58ea"
            }
          },
          "metadata": {}
        },
        {
          "output_type": "stream",
          "name": "stderr",
          "text": [
            "\n",
            "Downloading data:   0%|          | 0.00/249M [00:00<?, ?B/s]\u001b[A\n",
            "Downloading data:   4%|▍         | 10.5M/249M [00:00<00:05, 40.8MB/s]\u001b[A\n",
            "Downloading data:  17%|█▋        | 41.9M/249M [00:00<00:01, 127MB/s] \u001b[A\n",
            "Downloading data:  30%|██▉       | 73.4M/249M [00:00<00:00, 178MB/s]\u001b[A\n",
            "Downloading data:  42%|████▏     | 105M/249M [00:00<00:00, 209MB/s] \u001b[A\n",
            "Downloading data:  55%|█████▍    | 136M/249M [00:00<00:00, 226MB/s]\u001b[A\n",
            "Downloading data:  67%|██████▋   | 168M/249M [00:00<00:00, 237MB/s]\u001b[A\n",
            "Downloading data:  80%|████████  | 199M/249M [00:00<00:00, 243MB/s]\u001b[A\n",
            "Downloading data: 100%|██████████| 249M/249M [00:01<00:00, 210MB/s]\n",
            "\n",
            "Downloading data:   0%|          | 0.00/248M [00:00<?, ?B/s]\u001b[A\n",
            "Downloading data:   4%|▍         | 10.5M/248M [00:00<00:06, 38.3MB/s]\u001b[A\n",
            "Downloading data:  17%|█▋        | 41.9M/248M [00:00<00:01, 126MB/s] \u001b[A\n",
            "Downloading data:  30%|██▉       | 73.4M/248M [00:00<00:00, 178MB/s]\u001b[A\n",
            "Downloading data:  42%|████▏     | 105M/248M [00:00<00:00, 211MB/s] \u001b[A\n",
            "Downloading data:  55%|█████▍    | 136M/248M [00:00<00:00, 229MB/s]\u001b[A\n",
            "Downloading data:  68%|██████▊   | 168M/248M [00:00<00:00, 243MB/s]\u001b[A\n",
            "Downloading data:  80%|████████  | 199M/248M [00:00<00:00, 249MB/s]\u001b[A\n",
            "Downloading data: 100%|██████████| 248M/248M [00:01<00:00, 206MB/s]\n",
            "\n",
            "Downloading data:   0%|          | 0.00/246M [00:00<?, ?B/s]\u001b[A\n",
            "Downloading data:   4%|▍         | 10.5M/246M [00:00<00:03, 71.5MB/s]\u001b[A\n",
            "Downloading data:  17%|█▋        | 41.9M/246M [00:00<00:01, 174MB/s] \u001b[A\n",
            "Downloading data:  30%|██▉       | 73.4M/246M [00:00<00:00, 211MB/s]\u001b[A\n",
            "Downloading data:  43%|████▎     | 105M/246M [00:00<00:00, 238MB/s] \u001b[A\n",
            "Downloading data:  55%|█████▌    | 136M/246M [00:00<00:00, 248MB/s]\u001b[A\n",
            "Downloading data:  68%|██████▊   | 168M/246M [00:00<00:00, 235MB/s]\u001b[A\n",
            "Downloading data:  81%|████████  | 199M/246M [00:01<00:00, 117MB/s]\u001b[A\n",
            "Downloading data: 100%|██████████| 246M/246M [00:03<00:00, 63.1MB/s]\n",
            "\n",
            "Downloading data:   0%|          | 0.00/248M [00:00<?, ?B/s]\u001b[A\n",
            "Downloading data:   4%|▍         | 10.5M/248M [00:00<00:02, 81.3MB/s]\u001b[A\n",
            "Downloading data:  17%|█▋        | 41.9M/248M [00:00<00:01, 196MB/s] \u001b[A\n",
            "Downloading data:  30%|██▉       | 73.4M/248M [00:00<00:00, 218MB/s]\u001b[A\n",
            "Downloading data:  42%|████▏     | 105M/248M [00:00<00:00, 227MB/s] \u001b[A\n",
            "Downloading data:  55%|█████▍    | 136M/248M [00:00<00:00, 238MB/s]\u001b[A\n",
            "Downloading data:  68%|██████▊   | 168M/248M [00:00<00:00, 242MB/s]\u001b[A\n",
            "Downloading data:  80%|████████  | 199M/248M [00:00<00:00, 241MB/s]\u001b[A\n",
            "Downloading data: 100%|██████████| 248M/248M [00:01<00:00, 218MB/s]\n",
            "\n",
            "Downloading data:   0%|          | 0.00/9.99M [00:00<?, ?B/s]\u001b[A\n",
            "Downloading data: 100%|██████████| 9.99M/9.99M [00:00<00:00, 61.2MB/s]\n"
          ]
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "Extracting data files:   0%|          | 0/2 [00:00<?, ?it/s]"
            ],
            "application/vnd.jupyter.widget-view+json": {
              "version_major": 2,
              "version_minor": 0,
              "model_id": "ac8a44eaaf6c41e2a457c4edb8e12263"
            }
          },
          "metadata": {}
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "Generating train split: 0 examples [00:00, ? examples/s]"
            ],
            "application/vnd.jupyter.widget-view+json": {
              "version_major": 2,
              "version_minor": 0,
              "model_id": "1ea2cb07ffb2430bbc1cf4df7ad92352"
            }
          },
          "metadata": {}
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "Generating validation split: 0 examples [00:00, ? examples/s]"
            ],
            "application/vnd.jupyter.widget-view+json": {
              "version_major": 2,
              "version_minor": 0,
              "model_id": "6fdbd0591b4d451baa5002fca1717507"
            }
          },
          "metadata": {}
        },
        {
          "output_type": "error",
          "ename": "NotImplementedError",
          "evalue": "Loading a dataset cached in a LocalFileSystem is not supported.",
          "traceback": [
            "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
            "\u001b[0;31mNotImplementedError\u001b[0m                       Traceback (most recent call last)",
            "\u001b[0;32m/tmp/ipython-input-10-970099053.py\u001b[0m in \u001b[0;36m<cell line: 0>\u001b[0;34m()\u001b[0m\n\u001b[1;32m     14\u001b[0m \u001b[0mget_ipython\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msystem\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m'rm -rf ./tmp_dataset_cache'\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     15\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 16\u001b[0;31m \u001b[0mds\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mload_dataset\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\"roneneldan/TinyStories\"\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdownload_mode\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m\"force_redownload\"\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m",
            "\u001b[0;32m/usr/local/lib/python3.11/dist-packages/datasets/load.py\u001b[0m in \u001b[0;36mload_dataset\u001b[0;34m(path, name, data_dir, data_files, split, cache_dir, features, download_config, download_mode, verification_mode, ignore_verifications, keep_in_memory, save_infos, revision, token, use_auth_token, task, streaming, num_proc, storage_options, **config_kwargs)\u001b[0m\n\u001b[1;32m   2147\u001b[0m         \u001b[0mkeep_in_memory\u001b[0m \u001b[0;32mif\u001b[0m \u001b[0mkeep_in_memory\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0;32mNone\u001b[0m \u001b[0;32melse\u001b[0m \u001b[0mis_small_dataset\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mbuilder_instance\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0minfo\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mdataset_size\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   2148\u001b[0m     )\n\u001b[0;32m-> 2149\u001b[0;31m     \u001b[0mds\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mbuilder_instance\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mas_dataset\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0msplit\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0msplit\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mverification_mode\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mverification_mode\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0min_memory\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mkeep_in_memory\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   2150\u001b[0m     \u001b[0;31m# Rename and cast features to match task schema\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   2151\u001b[0m     \u001b[0;32mif\u001b[0m \u001b[0mtask\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;32m/usr/local/lib/python3.11/dist-packages/datasets/builder.py\u001b[0m in \u001b[0;36mas_dataset\u001b[0;34m(self, split, run_post_process, verification_mode, ignore_verifications, in_memory)\u001b[0m\n\u001b[1;32m   1171\u001b[0m         \u001b[0mis_local\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0mis_remote_filesystem\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_fs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1172\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0mis_local\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1173\u001b[0;31m             \u001b[0;32mraise\u001b[0m \u001b[0mNotImplementedError\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34mf\"Loading a dataset cached in a {type(self._fs).__name__} is not supported.\"\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1174\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0mos\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mpath\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mexists\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_output_dir\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1175\u001b[0m             raise FileNotFoundError(\n",
            "\u001b[0;31mNotImplementedError\u001b[0m: Loading a dataset cached in a LocalFileSystem is not supported."
          ]
        }
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "## Step 2: Tokenize the Dataset\n",
        "\n",
        "In this step, we will do the following:\n",
        "\n",
        "(1) Tokenize the dataset into tokenIDs.\n",
        "\n",
        "(2) Create a file called \"train.bin\" and \"validtion.bin\" where we will store the tokenIDs from the entire dataset.\n",
        "\n",
        "(3) We make sure the tokenIDs are stored on a disk, rather than on the RAM for efficient computations."
      ],
      "metadata": {
        "id": "vccyr4qKR6OH"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "!pip install tiktoken\n",
        "import tiktoken\n",
        "import os\n",
        "import numpy as np\n",
        "from tqdm.auto import tqdm\n",
        "\n",
        "enc = tiktoken.get_encoding(\"gpt2\")\n",
        "\n",
        "\n",
        "\n",
        "# Some functions from https://github.com/karpathy/nanoGPT/blob/master/data/openwebtext/prepare.py\n",
        "\n",
        "def process(example):\n",
        "    ids = enc.encode_ordinary(example['text']) # encode_ordinary ignores any special tokens\n",
        "    out = {'ids': ids, 'len': len(ids)}\n",
        "    return out\n",
        "\n",
        "if not os.path.exists(\"train.bin\"):\n",
        "    tokenized = dataset.map(\n",
        "        process,\n",
        "        remove_columns=['text'],\n",
        "        desc=\"tokenizing the splits\",\n",
        "        num_proc=8,\n",
        "        )\n",
        "    # concatenate all the ids in each dataset into one large file we can use for training\n",
        "    for split, dset in tokenized.items():\n",
        "        arr_len = np.sum(dset['len'], dtype=np.uint64)\n",
        "        filename = f'{split}.bin'\n",
        "        dtype = np.uint16 # (can do since enc.max_token_value == 50256 is < 2**16)\n",
        "        arr = np.memmap(filename, dtype=dtype, mode='w+', shape=(arr_len,))\n",
        "        total_batches = 1024\n",
        "\n",
        "        idx = 0\n",
        "        for batch_idx in tqdm(range(total_batches), desc=f'writing {filename}'):\n",
        "            # Batch together samples for faster write\n",
        "            batch = dset.shard(num_shards=total_batches, index=batch_idx, contiguous=True).with_format('numpy')\n",
        "            arr_batch = np.concatenate(batch['ids'])\n",
        "            # Write into mmap\n",
        "            arr[idx : idx + len(arr_batch)] = arr_batch\n",
        "            idx += len(arr_batch)\n",
        "        arr.flush()"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 197,
          "referenced_widgets": [
            "cefd811f78284690a10f8b819af34149",
            "7d63cfcb30784c1392f1db1e96ba0b77",
            "a54ae6736dc0437e84dd5b95609b9ffc",
            "1dfe7e0968d6466fb4271eb037f16449",
            "29b5772b0e754925b0c6982ef941f7f6",
            "6c7e2e53ad004af78a81ba18489d944a",
            "b833fed1112c45a9b84e560ed45a6265",
            "2509af00dd7541ab9321b5c7c0b14d72",
            "a762b6729df6481c8fadf0ff284d66b1",
            "6005263c1eb04ab9abaaa25e10117132",
            "d547f89914c24762865873572989ec1a"
          ]
        },
        "id": "vFkgAjyMR8fa",
        "outputId": "0e576324-715e-4276-c8ed-9aad449123a0"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Requirement already satisfied: tiktoken in /usr/local/lib/python3.11/dist-packages (0.9.0)\n",
            "Requirement already satisfied: regex>=2022.1.18 in /usr/local/lib/python3.11/dist-packages (from tiktoken) (2024.11.6)\n",
            "Requirement already satisfied: requests>=2.26.0 in /usr/local/lib/python3.11/dist-packages (from tiktoken) (2.32.3)\n",
            "Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.11/dist-packages (from requests>=2.26.0->tiktoken) (3.4.2)\n",
            "Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.11/dist-packages (from requests>=2.26.0->tiktoken) (3.10)\n",
            "Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.11/dist-packages (from requests>=2.26.0->tiktoken) (2.5.0)\n",
            "Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.11/dist-packages (from requests>=2.26.0->tiktoken) (2025.7.14)\n"
          ]
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "tokenizing the splits (num_proc=8):   0%|          | 0/14074715 [00:00<?, ? examples/s]"
            ],
            "application/vnd.jupyter.widget-view+json": {
              "version_major": 2,
              "version_minor": 0,
              "model_id": "cefd811f78284690a10f8b819af34149"
            }
          },
          "metadata": {}
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "git lfs install"
      ],
      "metadata": {
        "id": "gHJ0AIBz9oy8"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "from datasets import Dataset, DatasetDict\n",
        "import random\n",
        "\n",
        "# Load the giant dataset\n",
        "full_dataset = Dataset.from_json(\"/content/TinyStories/train.jsonl\")\n",
        "\n",
        "# Set seed for reproducibility\n",
        "random.seed(42)\n",
        "\n",
        "# Shuffle and split\n",
        "full_dataset = full_dataset.shuffle(seed=42)\n",
        "split_datasets = full_dataset.train_test_split(test_size=0.05)\n",
        "\n",
        "# Save them to disk if needed\n",
        "split_datasets['train'].to_json(\"/content/TinyStories/train_split.jsonl\")\n",
        "split_datasets['test'].to_json(\"/content/TinyStories/val_split.jsonl\")\n",
        "\n",
        "# Wrap into DatasetDict\n",
        "dataset = DatasetDict({\n",
        "    \"train\": split_datasets['train'],\n",
        "    \"validation\": split_datasets['test']\n",
        "})"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 81,
          "referenced_widgets": [
            "f6e477bb2f64409cae97c6bd77cb097e",
            "5d9644e7af6647cfb12e97cf1d567b46",
            "2698092978b5483bbf4fcc4f249c44d3",
            "e6464914ded442f8b6d00d61e36be544",
            "683583c2734545c49bb2a4b9dbd597f0",
            "a97a3703110d42e0b91219ccfa8c8fc4",
            "2923c0582d4d4e8c9970632bff0e2398",
            "fc647eb3702b4d4a8277a797c101c446",
            "7815db21ab414d2780d01fb888d24429",
            "7a9128601ef04a1799d07b1b6320452e",
            "d86df11a6f1546feb30a3c930212d9fd",
            "62a01500ccae4c739a42b12022f8ce43",
            "5e25bd75ee844e589732d96f129607c5",
            "124fe82a766d48199ded978cfd6b64bc",
            "19e631fae52a442b886e36500020b32a",
            "56e51145d5384edb87a4ead6ca9adbbf",
            "e56b01c7ceb8409f96548ffc41514174",
            "b50b9c65606a409681d1569f7863d813",
            "620dc645841241a6b86550bf5884ed09",
            "b49edfa15e2445ab812be37f6364d555",
            "11bafebaed264db0936051e26d43b6e5",
            "b4dbf2c06ec04d2194e1c2baefa3ffac"
          ]
        },
        "id": "kPx6WN9N0gy5",
        "outputId": "bd70e66e-a2ad-4043-8b6b-9cf84d2b4f0b"
      },
      "execution_count": 5,
      "outputs": [
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "Creating json from Arrow format:   0%|          | 0/14075 [00:00<?, ?ba/s]"
            ],
            "application/vnd.jupyter.widget-view+json": {
              "version_major": 2,
              "version_minor": 0,
              "model_id": "f6e477bb2f64409cae97c6bd77cb097e"
            }
          },
          "metadata": {}
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "Creating json from Arrow format:   0%|          | 0/741 [00:00<?, ?ba/s]"
            ],
            "application/vnd.jupyter.widget-view+json": {
              "version_major": 2,
              "version_minor": 0,
              "model_id": "62a01500ccae4c739a42b12022f8ce43"
            }
          },
          "metadata": {}
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "!nvidia-smi"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "afaEj3JZxuzU",
        "outputId": "1b3e1209-86a3-41a1-f0c4-60de9282f529"
      },
      "execution_count": 6,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Wed Jul 23 15:19:38 2025       \n",
            "+-----------------------------------------------------------------------------------------+\n",
            "| NVIDIA-SMI 550.54.15              Driver Version: 550.54.15      CUDA Version: 12.4     |\n",
            "|-----------------------------------------+------------------------+----------------------+\n",
            "| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |\n",
            "| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |\n",
            "|                                         |                        |               MIG M. |\n",
            "|=========================================+========================+======================|\n",
            "|   0  Tesla T4                       Off |   00000000:00:04.0 Off |                    0 |\n",
            "| N/A   40C    P8              9W /   70W |       0MiB /  15360MiB |      0%      Default |\n",
            "|                                         |                        |                  N/A |\n",
            "+-----------------------------------------+------------------------+----------------------+\n",
            "                                                                                         \n",
            "+-----------------------------------------------------------------------------------------+\n",
            "| Processes:                                                                              |\n",
            "|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |\n",
            "|        ID   ID                                                               Usage      |\n",
            "|=========================================================================================|\n",
            "|  No running processes found                                                             |\n",
            "+-----------------------------------------------------------------------------------------+\n"
          ]
        }
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "## Step 3: Create Input-Output batches for the dataset"
      ],
      "metadata": {
        "id": "X_qRtn_WSbV4"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "# Some functions from https://github.com/karpathy/nanoGPT/blob/master/train.py with slight modifications\n",
        "def get_batch(split):\n",
        "    # We recreate np.memmap every batch to avoid a memory leak, as per\n",
        "    # https://stackoverflow.com/questions/45132940/numpy-memmap-memory-usage-want-to-iterate-once/61472122#61472122\n",
        "    if split == 'train':\n",
        "        data = np.memmap('train.bin', dtype=np.uint16, mode='r')\n",
        "    else:\n",
        "        data = np.memmap('validation.bin', dtype=np.uint16, mode='r')\n",
        "    ix = torch.randint(len(data) - block_size, (batch_size,))\n",
        "    x = torch.stack([torch.from_numpy((data[i:i+block_size]).astype(np.int64)) for i in ix])\n",
        "    y = torch.stack([torch.from_numpy((data[i+1:i+1+block_size]).astype(np.int64)) for i in ix])\n",
        "    if device_type == 'cuda':\n",
        "        # pin arrays x,y, which allows us to move them to GPU asynchronously (non_blocking=True)\n",
        "        x, y = x.pin_memory().to(device, non_blocking=True), y.pin_memory().to(device, non_blocking=True)\n",
        "    else:\n",
        "        x, y = x.to(device), y.to(device)\n",
        "    return x, y\n"
      ],
      "metadata": {
        "id": "gak79CZESkjN"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "kA1SVp1hkjKy"
      },
      "source": [
        "## Step 4: Define the SLM Model Architecture"
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "import torch\n",
        "import torch.nn as nn\n",
        "import torch.nn.functional as F\n",
        "import math\n",
        "from dataclasses import dataclass\n",
        "import numpy as np\n",
        "from tqdm.auto import tqdm\n",
        "from contextlib import nullcontext\n",
        "import os\n",
        "\n",
        "class LayerNorm(nn.Module):\n",
        "    def __init__(self, ndim, bias):\n",
        "        super().__init__()\n",
        "        self.weight = nn.Parameter(torch.ones(ndim))\n",
        "        self.bias = nn.Parameter(torch.zeros(ndim)) if bias else None\n",
        "    def forward(self, x):\n",
        "        return F.layer_norm(x, self.weight.shape, self.weight, self.bias, 1e-5)\n",
        "\n",
        "class CausalSelfAttention(nn.Module):\n",
        "    def __init__(self, config):\n",
        "        super().__init__()\n",
        "        assert config.n_embd % config.n_head == 0\n",
        "        self.c_attn = nn.Linear(config.n_embd, 3 * config.n_embd, bias=config.bias)\n",
        "        self.c_proj = nn.Linear(config.n_embd, config.n_embd, bias=config.bias)\n",
        "        self.attn_dropout = nn.Dropout(config.dropout)\n",
        "        self.resid_dropout = nn.Dropout(config.dropout)\n",
        "        self.n_head = config.n_head\n",
        "        self.n_embd = config.n_embd\n",
        "        self.flash = hasattr(F, 'scaled_dot_product_attention')\n",
        "        if not self.flash:\n",
        "            self.register_buffer(\"bias\", torch.tril(torch.ones(config.block_size, config.block_size))\n",
        "                                       .view(1, 1, config.block_size, config.block_size))\n",
        "\n",
        "    def forward(self, x):\n",
        "        B, T, C = x.size()\n",
        "        q, k, v = self.c_attn(x).split(self.n_embd, dim=2)\n",
        "        k = k.view(B, T, self.n_head, C // self.n_head).transpose(1, 2)\n",
        "        q = q.view(B, T, self.n_head, C // self.n_head).transpose(1, 2)\n",
        "        v = v.view(B, T, self.n_head, C // self.n_head).transpose(1, 2)\n",
        "\n",
        "        if self.flash:\n",
        "            y = F.scaled_dot_product_attention(q, k, v, attn_mask=None, dropout_p=self.attn_dropout.p if self.training else 0.0, is_causal=True)\n",
        "        else:\n",
        "            att = (q @ k.transpose(-2, -1)) * (1.0 / math.sqrt(k.size(-1)))\n",
        "            att = att.masked_fill(self.bias[:, :, :T, :T] == 0, float('-inf'))\n",
        "            att = F.softmax(att, dim=-1)\n",
        "            att = self.attn_dropout(att)\n",
        "            y = att @ v\n",
        "\n",
        "        y = y.transpose(1, 2).contiguous().view(B, T, C)\n",
        "        y = self.resid_dropout(self.c_proj(y))\n",
        "        return y\n",
        "\n",
        "class MLP(nn.Module):\n",
        "    def __init__(self, config):\n",
        "        super().__init__()\n",
        "        self.c_fc = nn.Linear(config.n_embd, 4 * config.n_embd, bias=config.bias)\n",
        "        self.gelu = nn.GELU()\n",
        "        self.c_proj = nn.Linear(4 * config.n_embd, config.n_embd, bias=config.bias)\n",
        "        self.dropout = nn.Dropout(config.dropout)\n",
        "    def forward(self, x):\n",
        "        return self.dropout(self.c_proj(self.gelu(self.c_fc(x))))\n",
        "\n",
        "class Block(nn.Module):\n",
        "    def __init__(self, config):\n",
        "        super().__init__()\n",
        "        self.ln1 = LayerNorm(config.n_embd, config.bias)\n",
        "        self.attn = CausalSelfAttention(config)\n",
        "        self.ln2 = LayerNorm(config.n_embd, config.bias)\n",
        "        self.mlp = MLP(config)\n",
        "    def forward(self, x):\n",
        "        x = x + self.attn(self.ln1(x))\n",
        "        x = x + self.mlp(self.ln2(x))\n",
        "        return x\n",
        "\n",
        "@dataclass\n",
        "class GPTConfig:\n",
        "    block_size: int\n",
        "    vocab_size: int\n",
        "    n_layer: int\n",
        "    n_head: int\n",
        "    n_embd: int\n",
        "    dropout: float = 0.0\n",
        "    bias: bool = True\n",
        "\n",
        "class GPT(nn.Module):\n",
        "    def __init__(self, config):\n",
        "        super().__init__()\n",
        "        self.config = config\n",
        "        self.transformer = nn.ModuleDict(dict(\n",
        "            wte=nn.Embedding(config.vocab_size, config.n_embd),\n",
        "            wpe=nn.Embedding(config.block_size, config.n_embd),\n",
        "            drop=nn.Dropout(config.dropout),\n",
        "            h=nn.ModuleList([Block(config) for _ in range(config.n_layer)]),\n",
        "            ln_f=LayerNorm(config.n_embd, config.bias),\n",
        "        ))\n",
        "        self.lm_head = nn.Linear(config.n_embd, config.vocab_size, bias=False)\n",
        "        self.transformer.wte.weight = self.lm_head.weight  # weight tying\n",
        "\n",
        "        self.apply(self._init_weights)\n",
        "        for pn, p in self.named_parameters():\n",
        "            if pn.endswith('c_proj.weight'):\n",
        "                nn.init.normal_(p, mean=0.0, std=0.02 / math.sqrt(2 * config.n_layer))\n",
        "\n",
        "    def _init_weights(self, module):\n",
        "        if isinstance(module, nn.Linear):\n",
        "            nn.init.normal_(module.weight, mean=0.0, std=0.02)\n",
        "            if module.bias is not None:\n",
        "                nn.init.zeros_(module.bias)\n",
        "        elif isinstance(module, nn.Embedding):\n",
        "            nn.init.normal_(module.weight, mean=0.0, std=0.02)\n",
        "\n",
        "    def forward(self, idx, targets=None):\n",
        "        device = idx.device\n",
        "        b, t = idx.size()\n",
        "        assert t <= self.config.block_size\n",
        "        pos = torch.arange(0, t, dtype=torch.long, device=device)\n",
        "\n",
        "        tok_emb = self.transformer.wte(idx)\n",
        "        pos_emb = self.transformer.wpe(pos)\n",
        "        x = self.transformer.drop(tok_emb + pos_emb)\n",
        "        for block in self.transformer.h:\n",
        "            x = block(x)\n",
        "        x = self.transformer.ln_f(x)\n",
        "\n",
        "        if targets is not None:\n",
        "            logits = self.lm_head(x)\n",
        "            loss = F.cross_entropy(logits.view(-1, logits.size(-1)), targets.view(-1), ignore_index=-1)\n",
        "            return logits, loss\n",
        "        else:\n",
        "            logits = self.lm_head(x[:, [-1], :])\n",
        "            return logits, None\n",
        "\n",
        "    @torch.no_grad()\n",
        "    def generate(self, idx, max_new_tokens, temperature=1.0, top_k=None):\n",
        "        \"\"\"\n",
        "        Generate tokens given a conditioning sequence.\n",
        "        idx: Tensor of shape (B, T)\n",
        "        \"\"\"\n",
        "        for _ in range(max_new_tokens):\n",
        "            idx_cond = idx if idx.size(1) <= self.config.block_size else idx[:, -self.config.block_size:]\n",
        "            logits, _ = self(idx_cond)\n",
        "            logits = logits[:, -1, :] / temperature\n",
        "            if top_k is not None:\n",
        "                v, _ = torch.topk(logits, min(top_k, logits.size(-1)))\n",
        "                logits[logits < v[:, [-1]]] = -float('Inf')\n",
        "            probs = F.softmax(logits, dim=-1)\n",
        "            idx_next = torch.multinomial(probs, num_samples=1)\n",
        "            idx = torch.cat((idx, idx_next), dim=1)\n",
        "        return idx\n",
        "\n"
      ],
      "metadata": {
        "id": "9friaxWABOA-"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "execution": {
          "iopub.execute_input": "2024-06-20T15:36:54.88378Z",
          "iopub.status.busy": "2024-06-20T15:36:54.883342Z",
          "iopub.status.idle": "2024-06-20T15:37:07.278493Z",
          "shell.execute_reply": "2024-06-20T15:37:07.277342Z",
          "shell.execute_reply.started": "2024-06-20T15:36:54.883753Z"
        },
        "id": "uRm6WlvfkjKz",
        "trusted": true
      },
      "outputs": [],
      "source": [
        "config = GPTConfig(\n",
        "    vocab_size=50257,     # use the tokenizer's vocab size\n",
        "    block_size=128,       # or whatever context size you're training with\n",
        "    n_layer=6,\n",
        "    n_head=6,\n",
        "    n_embd=384,\n",
        "    dropout=0.1,\n",
        "    bias=True\n",
        ")\n",
        "\n",
        "model = GPT(config)"
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "## Step 5: Define the loss function"
      ],
      "metadata": {
        "id": "C_a8Rd-0S_WC"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "def estimate_loss(model):\n",
        "    out = {}\n",
        "    model.eval()\n",
        "    with torch.inference_mode():\n",
        "        for split in ['train', 'val']:\n",
        "            losses = torch.zeros(eval_iters)\n",
        "            for k in range(eval_iters):\n",
        "                X, Y = get_batch(split)\n",
        "                with ctx:\n",
        "                    logits, loss = model(X, Y)\n",
        "                losses[k] = loss.item()\n",
        "            out[split] = losses.mean()\n",
        "    model.train()\n",
        "    return out"
      ],
      "metadata": {
        "id": "La2Aun_nTBzk"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "source": [
        "## Step 6: Define SLM Training Configuration Part 1"
      ],
      "metadata": {
        "id": "UvqWPUstTRXO"
      }
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "8QQyayhnkjK5",
        "outputId": "f0fe5364-9079-4e21-ccd2-28c345843035",
        "trusted": true
      },
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "<torch._C.Generator at 0x7852bcd8f770>"
            ]
          },
          "metadata": {},
          "execution_count": 8
        }
      ],
      "source": [
        "# Training Config\n",
        "import torch\n",
        "from contextlib import nullcontext\n",
        "\n",
        "learning_rate = 1e-4 #more stable training, earlier 1e-4\n",
        "max_iters = 20000 #increase from 25000\n",
        "warmup_steps = 1000 #smoother initial train, earlier 100\n",
        "min_lr = 5e-4 #lower rate, earlier 5e-4\n",
        "eval_iters = 500 # increased from 100\n",
        "batch_size = 32 # changed from 16, better gradient estimate\n",
        "block_size = 128 #changed from 64, capture longer range dependencies\n",
        "\n",
        "gradient_accumulation_steps = 32 # reduced from 50\n",
        "\n",
        "device =  \"cuda\" if torch.cuda.is_available() else \"cpu\"\n",
        "device_type = 'cuda' if 'cuda' in device else 'cpu' # for later use in torch.autocast\n",
        "# note: float16 data type will automatically use a GradScaler\n",
        "\n",
        "# How to use autocast https://wandb.ai/wandb_fc/tips/reports/How-To-Use-Autocast-in-PyTorch--VmlldzoyMTk4NTky\n",
        "#dtype = 'bfloat16' if torch.cuda.is_available() and torch.cuda.is_bf16_supported() else 'float16' # 'float32', 'bfloat16', or 'float16', the latter will auto implement a GradScaler\n",
        "dtype = 'bfloat16' if torch.cuda.is_available() and torch.cuda.is_bf16_supported() else 'float16' # 'float32', 'bfloat16', or 'float16', the latter will auto implement a GradScaler\n",
        "ptdtype = {'float32': torch.float32, 'bfloat16': torch.bfloat16, 'float16': torch.float16}[dtype]\n",
        "\n",
        "ctx = nullcontext() if device_type == 'cpu' else torch.amp.autocast(device_type=device_type, dtype=ptdtype)\n",
        "\n",
        "torch.set_default_device(device)\n",
        "torch.manual_seed(42)"
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "## Step 7: Define SLM Training Configuration Part 2"
      ],
      "metadata": {
        "id": "cmWj6YcKTW_z"
      }
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "JMkO3FlNkjK6",
        "outputId": "94b8c3c3-8cc9-4e1a-b1f7-8ac64f706e25",
        "trusted": true
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stderr",
          "text": [
            "<ipython-input-9-a9032b47f003>:11: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.\n",
            "  scaler = torch.cuda.amp.GradScaler(enabled=(dtype == 'float16'))\n"
          ]
        }
      ],
      "source": [
        "from torch.optim.lr_scheduler import LinearLR,SequentialLR, CosineAnnealingLR\n",
        "\n",
        "##PUT IN WEIGHT DECAY, CHANGED BETA2 to 0.95\n",
        "optimizer =  torch.optim.AdamW(model.parameters(), lr=learning_rate, betas=(0.9, 0.95), weight_decay=0.1, eps=1e-9) #weight decay for regularization\n",
        "\n",
        "scheduler_warmup = LinearLR(optimizer, total_iters = warmup_steps) #Implement linear warmup\n",
        "scheduler_decay = CosineAnnealingLR(optimizer,T_max = max_iters - warmup_steps, eta_min = min_lr) #Implement lr decay\n",
        "scheduler = SequentialLR(optimizer, schedulers=[scheduler_warmup, scheduler_decay], milestones=[warmup_steps]) #Switching from warmup to decay\n",
        "\n",
        "# https://stackoverflow.com/questions/72534859/is-gradscaler-necessary-with-mixed-precision-training-with-pytorch\n",
        "scaler = torch.cuda.amp.GradScaler(enabled=(dtype == 'float16'))"
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "## Step 8: Pre-train the SLM"
      ],
      "metadata": {
        "id": "Nz8fPSKNTY3W"
      }
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 1000,
          "referenced_widgets": [
            "5e308879faac4365ba172205c84e83e1",
            "e08c8d5cb7d34620a20a4f9e1434f596",
            "4df0870113914b118fc9a1fa223e9386",
            "886e91c4e0974fd6848f051f7cc0bc90",
            "d34f594438bc42ffb64820d383c65a21",
            "bf3293a7a5d4437486c89e2bf12550a4",
            "41431326176b48f8bbb325c78b1bfafc",
            "86c06e5cb98e46c5b638ccb3c9b7ddab",
            "f34d4b7153d64f2ebd8878aef5ef31b0",
            "6c7ef71452e44376a6cf9eaaf36994d3",
            "eda6aac71b62411b99c738029695f91c"
          ]
        },
        "id": "t0l-YhockjK6",
        "outputId": "f77b5cf9-e9a7-4359-83e5-1de8f088a36b",
        "trusted": true
      },
      "outputs": [
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "  0%|          | 0/20000 [00:00<?, ?it/s]"
            ],
            "application/vnd.jupyter.widget-view+json": {
              "version_major": 2,
              "version_minor": 0,
              "model_id": "5e308879faac4365ba172205c84e83e1"
            }
          },
          "metadata": {}
        },
        {
          "output_type": "stream",
          "name": "stderr",
          "text": [
            "/usr/local/lib/python3.11/dist-packages/torch/optim/lr_scheduler.py:227: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate\n",
            "  warnings.warn(\n"
          ]
        },
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Epoch 500: train loss 9.4897, val loss 9.4957\n",
            "The current learning rate: 0.00007\n"
          ]
        },
        {
          "output_type": "stream",
          "name": "stderr",
          "text": [
            "/usr/local/lib/python3.11/dist-packages/torch/optim/lr_scheduler.py:243: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.\n",
            "  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)\n"
          ]
        },
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Epoch 1000: train loss 8.5043, val loss 8.5077\n",
            "The current learning rate: 0.00010\n",
            "Epoch 1500: train loss 7.5694, val loss 7.5678\n",
            "The current learning rate: 0.00010\n",
            "Epoch 2000: train loss 6.7185, val loss 6.7158\n",
            "The current learning rate: 0.00010\n",
            "Epoch 2500: train loss 6.0202, val loss 6.0208\n",
            "The current learning rate: 0.00011\n",
            "Epoch 3000: train loss 5.4947, val loss 5.4944\n",
            "The current learning rate: 0.00011\n",
            "Epoch 3500: train loss 5.0635, val loss 5.0636\n",
            "The current learning rate: 0.00012\n",
            "Epoch 4000: train loss 4.7260, val loss 4.7253\n",
            "The current learning rate: 0.00012\n",
            "Epoch 4500: train loss 4.4872, val loss 4.4745\n",
            "The current learning rate: 0.00013\n",
            "Epoch 5000: train loss 4.2713, val loss 4.2802\n",
            "The current learning rate: 0.00014\n",
            "Epoch 5500: train loss 4.0990, val loss 4.0995\n",
            "The current learning rate: 0.00015\n",
            "Epoch 6000: train loss 3.9773, val loss 3.9743\n",
            "The current learning rate: 0.00016\n",
            "Epoch 6500: train loss 3.8234, val loss 3.8265\n",
            "The current learning rate: 0.00018\n",
            "Epoch 7000: train loss 3.7000, val loss 3.7021\n",
            "The current learning rate: 0.00019\n",
            "Epoch 7500: train loss 3.5877, val loss 3.5922\n",
            "The current learning rate: 0.00020\n",
            "Epoch 8000: train loss 3.4900, val loss 3.4920\n",
            "The current learning rate: 0.00022\n",
            "Epoch 8500: train loss 3.3953, val loss 3.4047\n",
            "The current learning rate: 0.00024\n",
            "Epoch 9000: train loss 3.3121, val loss 3.3127\n",
            "The current learning rate: 0.00025\n",
            "Epoch 9500: train loss 3.2394, val loss 3.2417\n",
            "The current learning rate: 0.00027\n",
            "Epoch 10000: train loss 3.1679, val loss 3.1725\n",
            "The current learning rate: 0.00028\n",
            "Epoch 10500: train loss 3.1003, val loss 3.1015\n",
            "The current learning rate: 0.00030\n",
            "Epoch 11000: train loss 3.0328, val loss 3.0379\n",
            "The current learning rate: 0.00032\n",
            "Epoch 11500: train loss 2.9726, val loss 2.9808\n",
            "The current learning rate: 0.00033\n",
            "Epoch 12000: train loss 2.9250, val loss 2.9292\n",
            "The current learning rate: 0.00035\n",
            "Epoch 12500: train loss 2.8825, val loss 2.8847\n",
            "The current learning rate: 0.00036\n",
            "Epoch 13000: train loss 2.8308, val loss 2.8264\n",
            "The current learning rate: 0.00038\n",
            "Epoch 13500: train loss 2.7915, val loss 2.7893\n",
            "The current learning rate: 0.00040\n",
            "Epoch 14000: train loss 2.7407, val loss 2.7473\n",
            "The current learning rate: 0.00041\n",
            "Epoch 14500: train loss 2.6970, val loss 2.7039\n",
            "The current learning rate: 0.00042\n",
            "Epoch 15000: train loss 2.6630, val loss 2.6706\n",
            "The current learning rate: 0.00044\n",
            "Epoch 15500: train loss 2.6332, val loss 2.6300\n",
            "The current learning rate: 0.00045\n",
            "Epoch 16000: train loss 2.5869, val loss 2.5896\n",
            "The current learning rate: 0.00046\n",
            "Epoch 16500: train loss 2.5591, val loss 2.5615\n",
            "The current learning rate: 0.00047\n",
            "Epoch 17000: train loss 2.5194, val loss 2.5265\n",
            "The current learning rate: 0.00048\n",
            "Epoch 17500: train loss 2.4944, val loss 2.5034\n",
            "The current learning rate: 0.00048\n",
            "Epoch 18000: train loss 2.4572, val loss 2.4644\n",
            "The current learning rate: 0.00049\n",
            "Epoch 18500: train loss 2.4335, val loss 2.4413\n",
            "The current learning rate: 0.00049\n",
            "Epoch 19000: train loss 2.4041, val loss 2.4085\n",
            "The current learning rate: 0.00050\n",
            "Epoch 19500: train loss 2.3919, val loss 2.3918\n",
            "The current learning rate: 0.00050\n"
          ]
        }
      ],
      "source": [
        "best_val_loss = float('inf')\n",
        "best_model_params_path = \"best_model_params.pt\"\n",
        "train_loss_list, validation_loss_list = [], []\n",
        "\n",
        "# Ensure model is on the correct device\n",
        "model = model.to(device)\n",
        "\n",
        "# In your training loop\n",
        "for epoch in tqdm(range(max_iters)):\n",
        "    if epoch % eval_iters == 0 and epoch != 0:\n",
        "        # Ensure estimate_loss uses the correct device\n",
        "        losses = estimate_loss(model)\n",
        "        print(f\"Epoch {epoch}: train loss {losses['train']:.4f}, val loss {losses['val']:.4f}\")\n",
        "        print(f\"The current learning rate: {optimizer.param_groups[0]['lr']:.5f}\")\n",
        "        train_loss_list += [losses['train']]\n",
        "        validation_loss_list += [losses['val']]\n",
        "\n",
        "        if losses['val'] < best_val_loss:\n",
        "            best_val_loss = losses['val']\n",
        "            torch.save(model.state_dict(), best_model_params_path)\n",
        "\n",
        "    # Ensure X and y are on the correct device\n",
        "    X, y = get_batch(\"train\")\n",
        "    X, y = X.to(device), y.to(device)\n",
        "\n",
        "    with ctx:\n",
        "        logits, loss = model(X, y)\n",
        "        loss = loss / gradient_accumulation_steps\n",
        "        scaler.scale(loss).backward()\n",
        "\n",
        "    if ((epoch + 1) % gradient_accumulation_steps == 0) or (epoch + 1 == max_iters):\n",
        "        torch.nn.utils.clip_grad_norm_(model.parameters(), max_norm=0.5)\n",
        "        scaler.step(optimizer)\n",
        "        scaler.update()\n",
        "        optimizer.zero_grad(set_to_none=True)\n",
        "    scheduler.step()"
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "## Step 9: Plot the SLM Loss Function"
      ],
      "metadata": {
        "id": "pdzhSo_7TcgI"
      }
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 449
        },
        "id": "KSWpvAnakjK6",
        "outputId": "081faa0b-d6f6-4d37-b819-8ebb6fa9c034",
        "trusted": true
      },
      "outputs": [
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "<Figure size 640x480 with 1 Axes>"
            ],
            "image/png": "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\n"
          },
          "metadata": {}
        }
      ],
      "source": [
        "import matplotlib.pyplot as plt\n",
        "train_loss_list_converted = [i.cpu().detach() for i in train_loss_list]\n",
        "validation_loss_list_converted = [i.cpu().detach() for i in validation_loss_list]\n",
        "\n",
        "plt.plot(train_loss_list_converted, 'g', label='train_loss')\n",
        "plt.plot(validation_loss_list_converted, 'r', label='validation_loss')\n",
        "plt.xlabel(\"Steps - Every 100 epochs\")\n",
        "plt.ylabel(\"Loss\")\n",
        "plt.legend()\n",
        "plt.show()\n",
        "\n"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "G2ocyyQwkjK6"
      },
      "source": [
        "## Step 10: Run SLM Inference on our trained model"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "execution": {
          "iopub.execute_input": "2024-06-20T15:45:44.322237Z",
          "iopub.status.busy": "2024-06-20T15:45:44.321316Z",
          "iopub.status.idle": "2024-06-20T15:45:46.887084Z",
          "shell.execute_reply": "2024-06-20T15:45:46.886126Z",
          "shell.execute_reply.started": "2024-06-20T15:45:44.322203Z"
        },
        "id": "06NrdWKdkjK7",
        "outputId": "88525b71-a4ab-4867-b320-f6e0b23346ca",
        "trusted": true
      },
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "<All keys matched successfully>"
            ]
          },
          "metadata": {},
          "execution_count": 12
        }
      ],
      "source": [
        "#Load the model\n",
        "model = GPT(config)  # re-create the model with same config\n",
        "device =  \"cuda\" if torch.cuda.is_available() else \"cpu\"\n",
        "best_model_params_path = \"best_model_params.pt\"\n",
        "model.load_state_dict(torch.load(best_model_params_path, map_location=torch.device(device))) # load best model states\n"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "execution": {
          "iopub.execute_input": "2024-06-20T15:44:36.64937Z",
          "iopub.status.busy": "2024-06-20T15:44:36.64896Z",
          "iopub.status.idle": "2024-06-20T15:45:14.425576Z",
          "shell.execute_reply": "2024-06-20T15:45:14.424712Z",
          "shell.execute_reply.started": "2024-06-20T15:44:36.649341Z"
        },
        "id": "K8PgWXb-kjK7",
        "outputId": "486f01cd-acf7-431d-cfa7-2f36b600dee6",
        "trusted": true
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Once upon a time there was a pumpkin. It was very special. The pumpkin were very happy.\n",
            "\n",
            "One day, a kind lady came to the store to you. The delicious corn helped the bird play games alone. She had 2 laser soldiers who lived in the forest.\n",
            "\n",
            "The lady felt ashamed. Her friend said, \"Don't worry, I need a board!\"\n",
            "\n",
            "The witch said, \"I found it under the garden. TheyIt's important to help others and Dad do it. We need to be careful and be careful.\" The lady smiled and felt happy on herself. \n",
            "\n",
            " endAlright, the smell of the beautiful water, but it will take the more dimroom in the water.Once upon a time there was a little girl named Lily. She had a smelly coat with something very loud. One day, she knew she needed to explore more. It was a very special kind of him. \n",
            "\n",
            "Later that day, Lily went to the park and they saw many beautiful flowers she wanted\n"
          ]
        }
      ],
      "source": [
        "sentence = \"Once upon a time there was a pumpkin.\"\n",
        "context = (torch.tensor(enc.encode_ordinary(sentence)).unsqueeze(dim = 0))\n",
        "y = model.generate(context, 200)\n",
        "print(enc.decode(y.squeeze().tolist()))"
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "sentence = \"A little girl went to the woods\"\n",
        "context = (torch.tensor(enc.encode_ordinary(sentence)).unsqueeze(dim = 0))\n",
        "y = model.generate(context, 200)\n",
        "print(enc.decode(y.squeeze().tolist()))"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "OZsL_mONRZAO",
        "outputId": "df3f6ed6-858a-447d-8beb-9c49479bd039"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "A little girl went to the woods and she found a basket for her. In one he enjoyed the great basket and the tasty treats tall. Then, she decided to go home and the picnic.\n",
            "\n",
            "As they walked, the little girl was getting tired and didn't want to drink. She opened her pocket to her room and got out. She was would open their new diary! She had a shower and a hug, so she pulled out a big, feeling warm and warm. She hope even when it was time to eat from the fun to eat!Once upon a time there was a little girl named Abbie. Benny loved to know what powers. Her father argued and walked for a after her. \n",
            "\n",
            "When he got there, Katie got excited and started to feel very tired. She said please to the hospital but sometimes he didn't have enough dessert. He sighed and decided to go home.\n",
            "\n",
            "Bubbles was so happy and didn't like Freddy. He stayed away from the doctor and kept walking.\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "s_2WjvUszhIe"
      },
      "outputs": [],
      "source": [
        "from google.colab import runtime\n",
        "runtime.unassign()"
      ]
    }
  ],
  "metadata": {
    "colab": {
      "machine_shape": "hm",
      "provenance": [],
      "gpuType": "T4"
    },
    "kaggle": {
      "accelerator": "gpu",
      "dataSources": [],
      "dockerImageVersionId": 30732,
      "isGpuEnabled": true,
      "isInternetEnabled": true,
      "language": "python",
      "sourceType": "notebook"
    },
    "kernelspec": {
      "display_name": "Python 3",
      "name": "python3"
    },
    "language_info": {
      "codemirror_mode": {
        "name": "ipython",
        "version": 3
      },
      "file_extension": ".py",
      "mimetype": "text/x-python",
      "name": "python",
      "nbconvert_exporter": "python",
      "pygments_lexer": "ipython3",
      "version": "3.10.13"
    },
    
            "layout": "IPY_MODEL_89ee047f74e248228701ba9c12b77b54"
          }
        },
        "31658a697e7e438cbe7b41050873c640": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_9164bf72d04c479cb3976801a3c2a558",
            "placeholder": "​",
            "style": "IPY_MODEL_15aefbebba874c69813a2ebf972d592c",
            "value": "Extracting data files: 100%"
          }
        },
        "87736d9336e34289bed0bcf80274ec59": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "FloatProgressModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "FloatProgressModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "ProgressView",
            "bar_style": "success",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_1b3f1c80944147a885f5e12819480525",
            "max": 2,
            "min": 0,
            "orientation": "horizontal",
            "style": "IPY_MODEL_b3582aa66b924092a43f76135870e2f5",
            "value": 2
          }
        },
        "44552002ff1749da85e369d220f609df": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_ee32053db2ca4b279e77bcb72c7160c6",
            "placeholder": "​",
            "style": "IPY_MODEL_50252b5e89d14d70a977ba057b22d1c5",
            "value": " 2/2 [00:00&lt;00:00, 107.89it/s]"
          }
        },
        "89ee047f74e248228701ba9c12b77b54": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "9164bf72d04c479cb3976801a3c2a558": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "15aefbebba874c69813a2ebf972d592c": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        },
        "1b3f1c80944147a885f5e12819480525": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "b3582aa66b924092a43f76135870e2f5": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "ProgressStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "ProgressStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "bar_color": null,
            "description_width": ""
          }
        },
        "ee32053db2ca4b279e77bcb72c7160c6": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "50252b5e89d14d70a977ba057b22d1c5": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        },
        "1ea2cb07ffb2430bbc1cf4df7ad92352": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HBoxModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HBoxModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HBoxView",
            "box_style": "",
            "children": [
              "IPY_MODEL_039e4cf4cea94f08beb764ad880dbbb3",
              "IPY_MODEL_b40c76a699e44dbd8ab444c0a475cafa",
              "IPY_MODEL_aea486c77b694df3970fa1305694cd85"
            ],
            "layout": "IPY_MODEL_af7007cad5414aa39823bc8c38fce802"
          }
        },
        "039e4cf4cea94f08beb764ad880dbbb3": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_b8165231fe7946aa9a91af83a882bd2d",
            "placeholder": "​",
            "style": "IPY_MODEL_0dca51fe3d5949bc8b0875d56de35094",
            "value": "Generating train split: "
          }
        },
        "b40c76a699e44dbd8ab444c0a475cafa": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "FloatProgressModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "FloatProgressModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "ProgressView",
            "bar_style": "success",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_10c1ffe15a2d45e0b87d65cad404fd02",
            "max": 1,
            "min": 0,
            "orientation": "horizontal",
            "style": "IPY_MODEL_6c07e58ce662466380e27307f669d6ca",
            "value": 1
          }
        },
        "aea486c77b694df3970fa1305694cd85": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_398a9b23ec194939a29ab7d77dfe00e7",
            "placeholder": "​",
            "style": "IPY_MODEL_92a900a6ed89453db8181e69240cb2f7",
            "value": " 2119719/0 [00:13&lt;00:00, 252811.54 examples/s]"
          }
        },
        "af7007cad5414aa39823bc8c38fce802": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "b8165231fe7946aa9a91af83a882bd2d": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "0dca51fe3d5949bc8b0875d56de35094": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        },
        "10c1ffe15a2d45e0b87d65cad404fd02": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": "20px"
          }
        },
        "6c07e58ce662466380e27307f669d6ca": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "ProgressStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "ProgressStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "bar_color": null,
            "description_width": ""
          }
        },
        "398a9b23ec194939a29ab7d77dfe00e7": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "92a900a6ed89453db8181e69240cb2f7": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        },
        "6fdbd0591b4d451baa5002fca1717507": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HBoxModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HBoxModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HBoxView",
            "box_style": "",
            "children": [
              "IPY_MODEL_67bf28190ca0447eaf09524fed4c86ba",
              "IPY_MODEL_3e11b3fa13ab40e5a76f55c170a1492a",
              "IPY_MODEL_66321f4176ed439fb299623ed77a34fe"
            ],
            "layout": "IPY_MODEL_080701ac49b84b13ac6c3bb6a3b0794f"
          }
        },
        "67bf28190ca0447eaf09524fed4c86ba": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_b3d79fd9bc074f17aa77368232544627",
            "placeholder": "​",
            "style": "IPY_MODEL_289d2caa1583498f9c9a8501e2cf01a4",
            "value": "Generating validation split: "
          }
        },
        "3e11b3fa13ab40e5a76f55c170a1492a": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "FloatProgressModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "FloatProgressModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "ProgressView",
            "bar_style": "success",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_ff68f799f20a4fc5ba1778fcf6ea6074",
            "max": 1,
            "min": 0,
            "orientation": "horizontal",
            "style": "IPY_MODEL_932c8100c90645eb98a3f6b91ee7a97f",
            "value": 1
          }
        },
        "66321f4176ed439fb299623ed77a34fe": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_c7844193fdc24630ab01ce5eef6a2270",
            "placeholder": "​",
            "style": "IPY_MODEL_24099522850c43da9d4e8d05e5cf2548",
            "value": " 21990/0 [00:00&lt;00:00, 226011.90 examples/s]"
          }
        },
        "080701ac49b84b13ac6c3bb6a3b0794f": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "b3d79fd9bc074f17aa77368232544627": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "289d2caa1583498f9c9a8501e2cf01a4": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        },
        "ff68f799f20a4fc5ba1778fcf6ea6074": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": "20px"
          }
        },
        "932c8100c90645eb98a3f6b91ee7a97f": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "ProgressStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "ProgressStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "bar_color": null,
            "description_width": ""
          }
        },
        "c7844193fdc24630ab01ce5eef6a2270": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "24099522850c43da9d4e8d05e5cf2548": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        },
        "b341f76ab47c4aefafaaf7fdb48d7f87": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HBoxModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HBoxModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HBoxView",
            "box_style": "",
            "children": [
              "IPY_MODEL_6eac3ad88c764a38bd19cf3740c1f5a0",
              "IPY_MODEL_e537d49e35cb48469612017d96d67689",
              "IPY_MODEL_3b61944e18a347e4a88ff0b22e60e113"
            ],
            "layout": "IPY_MODEL_b3fe02f80d634358bc4dea909061b81d"
          }
        },
        "6eac3ad88c764a38bd19cf3740c1f5a0": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_f8abed28499e49508887710a07d5f230",
            "placeholder": "​",
            "style": "IPY_MODEL_30b8c8dc62a1479e91c1bfa35f7a6f76",
            "value": "Generating train split: "
          }
        },
        "e537d49e35cb48469612017d96d67689": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "FloatProgressModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "FloatProgressModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "ProgressView",
            "bar_style": "success",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_342488b1ebff470487902a3f10694c50",
            "max": 1,
            "min": 0,
            "orientation": "horizontal",
            "style": "IPY_MODEL_39984545f4554e8e99af81b4d1beca05",
            "value": 1
          }
        },
        "3b61944e18a347e4a88ff0b22e60e113": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_d4d7c7d656524fb9a69bd8a7cd92110a",
            "placeholder": "​",
            "style": "IPY_MODEL_2be100b93d6541edb230d2566bc56b7c",
            "value": " 14815490/0 [00:22&lt;00:00, 624047.49 examples/s]"
          }
        },
        "b3fe02f80d634358bc4dea909061b81d": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "f8abed28499e49508887710a07d5f230": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "30b8c8dc62a1479e91c1bfa35f7a6f76": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        },
        "342488b1ebff470487902a3f10694c50": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": "20px"
          }
        },
        "39984545f4554e8e99af81b4d1beca05": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "ProgressStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "ProgressStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "bar_color": null,
            "description_width": ""
          }
        },
        "d4d7c7d656524fb9a69bd8a7cd92110a": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "2be100b93d6541edb230d2566bc56b7c": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        },
        "cefd811f78284690a10f8b819af34149": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HBoxModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HBoxModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HBoxView",
            "box_style": "",
            "children": [
              "IPY_MODEL_7d63cfcb30784c1392f1db1e96ba0b77",
              "IPY_MODEL_a54ae6736dc0437e84dd5b95609b9ffc",
              "IPY_MODEL_1dfe7e0968d6466fb4271eb037f16449"
            ],
            "layout": "IPY_MODEL_29b5772b0e754925b0c6982ef941f7f6"
          }
        },
        "7d63cfcb30784c1392f1db1e96ba0b77": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_6c7e2e53ad004af78a81ba18489d944a",
            "placeholder": "​",
            "style": "IPY_MODEL_b833fed1112c45a9b84e560ed45a6265",
            "value": "tokenizing the splits (num_proc=8):  65%"
          }
        },
        "a54ae6736dc0437e84dd5b95609b9ffc": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "FloatProgressModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "FloatProgressModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "ProgressView",
            "bar_style": "",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_2509af00dd7541ab9321b5c7c0b14d72",
            "max": 14074715,
            "min": 0,
            "orientation": "horizontal",
            "style": "IPY_MODEL_a762b6729df6481c8fadf0ff284d66b1",
            "value": 9171933
          }
        },
        "1dfe7e0968d6466fb4271eb037f16449": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_6005263c1eb04ab9abaaa25e10117132",
            "placeholder": "​",
            "style": "IPY_MODEL_d547f89914c24762865873572989ec1a",
            "value": " 9171131/14074715 [20:55&lt;10:37, 7690.64 examples/s]"
          }
        },
        "29b5772b0e754925b0c6982ef941f7f6": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "6c7e2e53ad004af78a81ba18489d944a": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "b833fed1112c45a9b84e560ed45a6265": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        },
        "2509af00dd7541ab9321b5c7c0b14d72": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "a762b6729df6481c8fadf0ff284d66b1": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "ProgressStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "ProgressStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "bar_color": null,
            "description_width": ""
          }
        },
        "6005263c1eb04ab9abaaa25e10117132": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "d547f89914c24762865873572989ec1a": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        },
        "f6e477bb2f64409cae97c6bd77cb097e": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HBoxModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HBoxModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HBoxView",
            "box_style": "",
            "children": [
              "IPY_MODEL_5d9644e7af6647cfb12e97cf1d567b46",
              "IPY_MODEL_2698092978b5483bbf4fcc4f249c44d3",
              "IPY_MODEL_e6464914ded442f8b6d00d61e36be544"
            ],
            "layout": "IPY_MODEL_683583c2734545c49bb2a4b9dbd597f0"
          }
        },
        "5d9644e7af6647cfb12e97cf1d567b46": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_a97a3703110d42e0b91219ccfa8c8fc4",
            "placeholder": "​",
            "style": "IPY_MODEL_2923c0582d4d4e8c9970632bff0e2398",
            "value": "Creating json from Arrow format: 100%"
          }
        },
        "2698092978b5483bbf4fcc4f249c44d3": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "FloatProgressModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "FloatProgressModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "ProgressView",
            "bar_style": "success",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_fc647eb3702b4d4a8277a797c101c446",
            "max": 14075,
            "min": 0,
            "orientation": "horizontal",
            "style": "IPY_MODEL_7815db21ab414d2780d01fb888d24429",
            "value": 14075
          }
        },
        "e6464914ded442f8b6d00d61e36be544": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_7a9128601ef04a1799d07b1b6320452e",
            "placeholder": "​",
            "style": "IPY_MODEL_d86df11a6f1546feb30a3c930212d9fd",
            "value": " 14075/14075 [07:33&lt;00:00,  9.73ba/s]"
          }
        },
        "683583c2734545c49bb2a4b9dbd597f0": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "a97a3703110d42e0b91219ccfa8c8fc4": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "2923c0582d4d4e8c9970632bff0e2398": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        },
        "fc647eb3702b4d4a8277a797c101c446": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "7815db21ab414d2780d01fb888d24429": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "ProgressStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "ProgressStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "bar_color": null,
            "description_width": ""
          }
        },
        "7a9128601ef04a1799d07b1b6320452e": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "d86df11a6f1546feb30a3c930212d9fd": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        },
        "62a01500ccae4c739a42b12022f8ce43": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HBoxModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HBoxModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HBoxView",
            "box_style": "",
            "children": [
              "IPY_MODEL_5e25bd75ee844e589732d96f129607c5",
              "IPY_MODEL_124fe82a766d48199ded978cfd6b64bc",
              "IPY_MODEL_19e631fae52a442b886e36500020b32a"
            ],
            "layout": "IPY_MODEL_56e51145d5384edb87a4ead6ca9adbbf"
          }
        },
        "5e25bd75ee844e589732d96f129607c5": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_e56b01c7ceb8409f96548ffc41514174",
            "placeholder": "​",
            "style": "IPY_MODEL_b50b9c65606a409681d1569f7863d813",
            "value": "Creating json from Arrow format: 100%"
          }
        },
        "124fe82a766d48199ded978cfd6b64bc": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "FloatProgressModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "FloatProgressModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "ProgressView",
            "bar_style": "success",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_620dc645841241a6b86550bf5884ed09",
            "max": 741,
            "min": 0,
            "orientation": "horizontal",
            "style": "IPY_MODEL_b49edfa15e2445ab812be37f6364d555",
            "value": 741
          }
        },
        "19e631fae52a442b886e36500020b32a": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_11bafebaed264db0936051e26d43b6e5",
            "placeholder": "​",
            "style": "IPY_MODEL_b4dbf2c06ec04d2194e1c2baefa3ffac",
            "value": " 741/741 [00:41&lt;00:00, 132.32ba/s]"
          }
        },
        "56e51145d5384edb87a4ead6ca9adbbf": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "e56b01c7ceb8409f96548ffc41514174": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "b50b9c65606a409681d1569f7863d813": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        },
        "620dc645841241a6b86550bf5884ed09": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "b49edfa15e2445ab812be37f6364d555": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "ProgressStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "ProgressStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "bar_color": null,
            "description_width": ""
          }
        },
        "11bafebaed264db0936051e26d43b6e5": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "b4dbf2c06ec04d2194e1c2baefa3ffac": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        }
      }
    },
    "accelerator": "GPU"
  },
  "nbformat": 4,
  "nbformat_minor": 0
}
